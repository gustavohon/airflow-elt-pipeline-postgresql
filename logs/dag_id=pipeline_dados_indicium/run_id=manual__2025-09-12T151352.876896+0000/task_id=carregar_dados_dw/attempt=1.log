{"timestamp":"2025-09-12T15:14:25.199579","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-09-12T15:14:25.211674","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/pipeline_indicium.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-09-12T15:14:25.940016Z","level":"info","event":"Task instance is in running state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:25.951417Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:25.955260Z","level":"info","event":"Current task name:carregar_dados_dw","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:25.966532Z","level":"info","event":"Dag name:pipeline_dados_indicium","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:25.989699Z","level":"info","event":"Iniciando o carregamento dos dados para o Data Warehouse...","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:26.010082Z","level":"info","event":"Conexão com o Data Warehouse bem-sucedida!","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:26.014919Z","level":"info","event":"Carregando dados do arquivo agencias_2025-09-12.csv para a tabela 'agencias'...","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:26.677110Z","level":"info","event":"Tabela 'agencias' carregada com sucesso.","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:26.678663Z","level":"info","event":"Carregando dados do arquivo clientes_2025-09-12.csv para a tabela 'clientes'...","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:27.390701Z","level":"info","event":"Tabela 'clientes' carregada com sucesso.","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:27.392337Z","level":"info","event":"Carregando dados do arquivo colaboradores_2025-09-12.csv para a tabela 'colaboradores'...","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:27.662653Z","level":"info","event":"Tabela 'colaboradores' carregada com sucesso.","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:27.663790Z","level":"info","event":"Carregando dados do arquivo contas_2025-09-12.csv para a tabela 'contas'...","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:28.257366Z","level":"info","event":"Tabela 'contas' carregada com sucesso.","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:28.292662Z","level":"info","event":"Carregando dados do arquivo transacoes_2025-09-12.csv para a tabela 'transacoes'...","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.305613Z","level":"info","event":"Ocorreu um erro durante o carregamento dos dados: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"pg_type_typname_nsp_index\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.308882Z","level":"info","event":"DETAIL:  Key (typname, typnamespace)=(transacoes, 2200) already exists.","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.310699Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.311348Z","level":"info","event":"[SQL:","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.311893Z","level":"info","event":"CREATE TABLE transacoes (","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.312425Z","level":"info","event":"\tcod_transacao BIGINT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.313026Z","level":"info","event":"\tnum_conta BIGINT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.313560Z","level":"info","event":"\tdata_transacao TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.314198Z","level":"info","event":"\tnome_transacao TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.319320Z","level":"info","event":"\tvalor_transacao FLOAT(53)","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.321696Z","level":"info","event":")","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.323983Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.331160Z","level":"info","event":"]","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.333054Z","level":"info","event":"(Background on this error at: https://sqlalche.me/e/14/gkpj)","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.336221Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.337411Z","level":"info","event":"Carregamento de dados para o Data Warehouse concluído!","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.305793","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"IntegrityError","exc_value":"(psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"pg_type_typname_nsp_index\"\nDETAIL:  Key (typname, typnamespace)=(transacoes, 2200) already exists.\n\n[SQL: \nCREATE TABLE transacoes (\n\tcod_transacao BIGINT, \n\tnum_conta BIGINT, \n\tdata_transacao TEXT, \n\tnome_transacao TEXT, \n\tvalor_transacao FLOAT(53)\n)\n\n]\n(Background on this error at: https://sqlalche.me/e/14/gkpj)","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":920,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1215,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":216,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":239,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/src/indicium-projeto/scripts/carregamento_dw.py","lineno":43,"name":"carregar_dados_no_dw"},{"filename":"/opt/airflow/src/indicium-projeto/scripts/carregamento_dw.py","lineno":38,"name":"carregar_dados_no_dw"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/util/_decorators.py","lineno":333,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py","lineno":3008,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":788,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":1948,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":1852,"name":"prep_table"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":936,"name":"create"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":922,"name":"_execute_create"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/schema.py","lineno":962,"name":"create"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":2221,"name":"_run_ddl_visitor"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/visitors.py","lineno":524,"name":"traverse_single"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py","lineno":899,"name":"visit_table"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1385,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/ddl.py","lineno":80,"name":"_execute_on_connection"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1477,"name":"_execute_ddl"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1953,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":2134,"name":"_handle_dbapi_exception"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py","lineno":211,"name":"raise_"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1910,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py","lineno":736,"name":"do_execute"}],"is_group":false,"exceptions":[]},{"exc_type":"UniqueViolation","exc_value":"duplicate key value violates unique constraint \"pg_type_typname_nsp_index\"\nDETAIL:  Key (typname, typnamespace)=(transacoes, 2200) already exists.\n","exc_notes":[],"syntax_error":null,"is_cause":true,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1910,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/default.py","lineno":736,"name":"do_execute"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-09-12T15:14:37.347738Z","level":"info","event":"Task instance in failure state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.370543Z","level":"info","event":"Task start","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.372669Z","level":"info","event":"Task:<Task(PythonOperator): carregar_dados_dw>","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.376699Z","level":"info","event":"Failure caused by (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint \"pg_type_typname_nsp_index\"","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.378945Z","level":"info","event":"DETAIL:  Key (typname, typnamespace)=(transacoes, 2200) already exists.","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.387314Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.388405Z","level":"info","event":"[SQL:","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.391114Z","level":"info","event":"CREATE TABLE transacoes (","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.393725Z","level":"info","event":"\tcod_transacao BIGINT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.397712Z","level":"info","event":"\tnum_conta BIGINT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.400553Z","level":"info","event":"\tdata_transacao TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.403571Z","level":"info","event":"\tnome_transacao TEXT,","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.404530Z","level":"info","event":"\tvalor_transacao FLOAT(53)","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.405426Z","level":"info","event":")","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.406142Z","level":"info","event":"","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.409844Z","level":"info","event":"]","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-12T15:14:37.414174Z","level":"info","event":"(Background on this error at: https://sqlalche.me/e/14/gkpj)","chan":"stdout","logger":"task"}
